---
title: "HSCI410ProjectB"
author: "Mark Ly"
date: "12/4/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(dplyr)
library(MASS)
library(ggplot2)

depdata <- dplyr::select(x, ADM_RNO, DODEP, DOWST, DEPDVSEV,GEN_015,GEN_020, GEN_025,LBFDGHPW,LBFDVPFT,LBFDGOCG,CCC_195,CCC_200,GEO_PRV,DHH_SEX,DHHGMS,DHHGAGE,SDCDGCGT,GENDVHDI,GENDVMHI,INCDGPER,INCDGHH,SWL_005,SWL_015,ALCDVTTM,ALC_015,SMK_005,SMKDVSTY,HWTDGISW,WST_035,SLP_015,EHG2DVR3,SACDVTER,SUI_010,WSTDVSKI,WSTDVPSY,WSTDVJIN,WSTDVPHY,WSTDVAUT,WSTDVJST,WSTDVSOC)

scale1 <- function(x){
  case_when(x %in% c("Poor")~0,
            x %in% c("Fair")~1,
            x %in% c("Good")~2,
            x %in% c("Very good")~3,
            x %in% c("Excellent")~4,
            x %in% c("Don't know")~9,
            x %in% c("Refusal")~9,
            x %in% c("Not stated")~9)
}
scale2 <- function(x){
  case_when(x %in% c("Married")~0,
            x %in% c("Common-law")~1,
            x %in% c("Widowed/Divorced/Separated")~2,
            x %in% c("Single")~3,
            x %in% c("Not stated")~9)
}

scale3 <- function(x){
  case_when(x %in% c("No depression")~0,
            x %in% c("Minimal depression")~1,
            x %in% c("Mild depression")~2,
            x %in% c("Moderate depression")~3,
            x %in% c("Moderately severe depression")~4,
            x %in% c("Severe depression")~5,
            x %in% c("Valid skip")~9,
            x %in% c("Not stated")~9)
}

scale4 <- function(x){
  case_when(x %in% c("Full-time")~0,
            x %in% c("Part-time")~1,
            x %in% c("Valid skip")~9,
            x %in% c("Not stated")~9)
}

scale5 <- function(x){
  case_when(x %in% c("No income or income loss")~0,
            x %in% c("Less than $20,000")~1,
            x %in% c("$20,000 to $39,999")~2,
            x %in% c("$40,000 to $59,999")~3,
            x %in% c("$60,000 to $79,999")~4,
            x %in% c("$80,000 or more")~5,
            x %in% c("Valid skip")~9,
            x %in% c("Not stated")~9)
}

scale6 <- function(x){
  case_when(x %in% c("Not at all satisfied")~0,
            x %in% c("Not too satisfied")~1,
            x %in% c("Somewhat satisfied")~2,
            x %in% c("Very satisfied")~3,
            x %in% c("Valid skip")~9,
            x %in% c("Don’t know")~9,
            x %in% c("Refusal")~9,
            x %in% c("Not stated")~9)
  
}

scale7 <- function(x){
  case_when(x %in% c("Not at all stressful")~0,
            x %in% c("Not very stressful")~1,
            x %in% c("A bit stressful")~2,
            x %in% c("Quite a bit stressful")~3,
            x %in% c("Extremely stressful")~4,
            x %in% c("Don’t know")~9,
            x %in% c("Refusal")~9,
            x %in% c("Valid skip")~9,
            x %in% c("Not stated")~9)
  
}

scale8 <- function(x){
  case_when(x %in% c("Strongly disagree")~0,
            x %in% c("Disagree")~1,
            x %in% c("Neither agree nor disagree")~2,
            x %in% c("Agree")~3,
            x %in% c("Strongly agree")~4,
            x %in% c("Valid skip")~9,
            x %in% c("Don’t know")~9,
            x %in% c("Not applicable")~9,
            x %in% c("Refusal")~9,
            x %in% c("Not stated")~9)
}

scale9<- function(x){
  case_when(x %in% c("Yes")~1,
            x %in% c("No")~0)
}

scale10 <- function(x){
  case_when(x %in% c("No income or less than $20,000")~0,
            x %in% c("$20,000 to $39,999")~1,
            x %in% c("$40,000 to $59,999")~2,
            x %in% c("$60,000 to $79,999")~3,
            x %in% c("$80,000 or more")~4,
            x %in% c("Not stated")~9)
}

scale11<- function(x){
  case_when(x %in% c("Very dissatisfied")~0,
            x %in% c("Dissatisfied")~1,
            x %in% c("Neither satisfied nor dissatisfied")~2,
            x %in% c("Satisfied")~3,
            x %in% c("Very satisfied")~4,
            x %in% c("Valid skip")~9,
            x %in% c("Refusal")~9,
            x %in% c("Not stated")~9,
            x %in% c("Don’t know")~9)
}

scale12<- function(x){
  case_when(x %in% c("Female")~0,
            x %in% c("Male")~1)
}

scale13<- function(x){
  case_when(x %in% c("BRITISH COLUMBIA")~0,
            x %in% c("ALBERTA")~1,
            x %in% c("SASKATCHEWAN")~2,
            x %in% c("MANITOBA")~3,
            x %in% c("ONTARIO")~4,
            x %in% c("QUEBEC")~5,
            x %in% c("NEW BRUNSWICK")~6,
            x %in% c("NOVA SCOTIA")~7,
            x %in% c("PRINCE EDWARD ISLAND")~8,
            x %in% c("NEWFOUNDLAND AND LABRADOR")~9,
            x %in% c("YUKON")~10,
            x %in% c("NUNAVUT")~11,
            x %in% c("NORTHWEST TERRITORIES")~12)
}

scale14<- function(x){
  case_when(x %in% c("Age between 12 and 14")~0,
            x %in% c("Age between 15 and 17")~1,
            x %in% c("Age between 18 and 19")~2,
            x %in% c("Age between 20 and 24")~3,
            x %in% c("Age between 25 and 29")~4,
            x %in% c("Age between 30 and 34")~5,
            x %in% c("Age between 35 and 39")~6,
            x %in% c("Age between 40 and 44")~7,
            x %in% c("Age between 45 and 49")~8,
            x %in% c("Age between 50 and 54")~9,
            x %in% c("Age between 55 and 59")~10,
            x %in% c("Age between 60 and 64")~11,
            x %in% c("Age between 65 and 69")~12,
            x %in% c("Age between 70 and 74")~13,
            x %in% c("Age between 75 and 79")~14,
            x %in% c("Age 80 and older")~15)
}

scale15<- function(x){
  case_when(x %in% c("[0-30)")~0,
            x %in% c("[30-40)")~1,
            x %in% c("[40-99)")~2)
}

scale16<- function(x){
  case_when(x %in% c("White")~0,
            x %in% c("Non-white (Aboriginal or Other Visible Minority)")~1,
            x %in% c("Valid skip")~9,
            x %in% c("Not stated")~9)
}

scale17<- function(x){
  case_when(x %in% c("Yes")~0,
            x %in% c("No")~1,
            x %in% c("Don't know")~9,
            x %in% c("Valid skip")~9,
            x %in% c("Not stated")~9)
}

scale19<- function(x){
  case_when(x %in% c("White")~0,
            x %in% c("Non-white (Aboriginal or Other Visible Minority)")~1)
}


scale20 <- function(x){
  case_when(x %in% c("Full-time")~0,
            x %in% c("Part-time")~1)
}

scale21<- function(x){
  case_when(x %in% c("NOC Code first digit: 1, 3, 4, 5, 6")~0,
            x %in% c("NOC Code first digit: 2")~1,
            x %in% c("NOC Code first digit: 6")~2,
            x %in% c("NOC Code first digit: 7")~3,
            x %in% c("NOC Code first digit: 8, 9")~4,
            x %in% c("Valid skip")~9,
            x %in% c("Not stated")~9)
}

scale22 <- function(x){
  case_when(x %in% c("Occasional drinker")~0,
            x %in% c("Regular drinker")~1)
}

scale23 <- function(x){
  case_when(x %in% c("Less than once a month")~0,
            x %in% c("Once a month")~1,
            x %in% c("2 to 3 times a month")~2,
            x %in% c("Once a week")~3,
            x %in% c("2 to 3 times a week")~4,
            x %in% c("4 to 6 times a week")~5,
            x %in% c("Every day")~6)
}

scale24<- function(x){
  case_when(x %in% c("Lifetime abstainer (never smoked a whole cigarette)")~0,
            x %in% c("Experimental smoker (at least 1 cig, non-smoker now)")~1,
            x %in% c("Former occasional smoker (non-smoker now)")~2,
            x %in% c("Former daily smoker (non-smoker now)")~3,
            x %in% c("Current occasional smoker")~4,
            x %in% c("Current daily smoker")~5,
            x %in% c("Not stated")~9)
}

scale25<- function(x){
  case_when(x %in% c("Normal weight")~0,
            x %in% c("Underweight")~1,
            x %in% c("Overweight")~2,
            x %in% c("Obese - Class I, II, III")~3,
            x %in% c("Not stated")~9)
}

scale26<- function(x){
  case_when(x %in% c("Never")~0,
            x %in% c("Rarely")~1,
            x %in% c("Sometimes")~2,
            x %in% c("Most of the time")~3,
            x %in% c("Sometimes")~4,
            x %in% c("All of the time")~5,
            x %in% c("Valid skip")~9,
            x %in% c("Not stated")~9)
}

scale27<- function(x){
  case_when(x %in% c("Less than secondary school graduation")~0,
            x %in% c("Secondary school graduation, no post-secondary education")~1,
            x %in% c("Post-secondary certificate diploma or univ degree")~2,
            x %in% c("Not stated")~9)
}

scale28<- function(x){
  case_when(x %in% c("Not at all")~0,
            x %in% c("Occasionally")~1,
            x %in% c("Daily")~2)
}
scale9b<- function(x){
  case_when(x %in% c("1")~"Yes",
            x %in% c("0")~"No")
}

#Apply scale to data
#depdata$DODEP <- sapply(depdata$DODEP,scale9)
#depdata$DOWST<- sapply(depdata$DOWST, scale9)

#Filtering out data
#33 columns 54992 selecting only those that report working hours.
depdata.hours <- depdata %>%
  filter(!LBFDGHPW %in% c("Not stated","Valid skip"))
depdata.hours$LBFDGHPW <- as.numeric(depdata.hours$LBFDGHPW)

#Filter out responses that are not stated #39033
depdata1 <- depdata.hours %>%
  filter(!LBFDGOCG %in% c("Not stated"),
         !INCDGHH %in% c("Not stated"),
         !EHG2DVR3 %in% c("Not stated"),
         !ALCDVTTM %in% c("Not stated"),
         !SDCDGCGT %in% c("Not stated", "Valid skip"),
         !DEPDVSEV %in% c("Not stated", "Valid skip"),
         !GEN_015 %in% c("Not stated", "Don't know","Refusal"),
         !GEN_020 %in% c("Not stated", "Don't know","Refusal"),
         !GEN_025 %in% c("Not stated", "Don't know","Refusal"),
         !DHHGMS %in% c("Not stated"),
         #!CCC_195 %in% c("Don't know", "Refusal"),
         #!CCC_200 %in% c("Don't know", "Refusal"),
         !GENDVHDI %in% c("Not stated"),
         !GENDVMHI %in% c("Not stated"),
         !INCDGPER %in% c("Valid skip","Not stated"),
         #!SWL_005 %in% c("Valid skip", "Don't know","Refusal","Not stated"),
         #!SWL_015 %in% c("Valid skip", "Don't know","Refusal","Not stated"),
         !ALC_015 %in% c("Valid skip"),
         !HWTDGISW %in% c("Valid skip", "Not stated"),
         !SMKDVSTY %in% c("Not stated"),
         !WSTDVSKI %in% c("Not stated","Valid skip"),
         !WSTDVPSY %in% c("Not stated","Valid skip"),
         !WSTDVJIN %in% c("Not stated","Valid skip"),
         !WSTDVPHY %in% c("Not stated","Valid skip"),
         !WSTDVAUT %in% c("Not stated","Valid skip"),
         !WSTDVJST %in% c("Not stated","Valid skip","(Other)"),
         !WSTDVSOC %in% c("Not stated","Valid skip")
  )



#3588 respondents 
depdata1$WSTDVSKI <- as.numeric(depdata1$WSTDVSKI)
depdata1$WSTDVPSY <- as.numeric(depdata1$WSTDVPSY)
depdata1$WSTDVJIN <- as.numeric(depdata1$WSTDVJIN)
depdata1$WSTDVPHY <- as.numeric(depdata1$WSTDVPHY)
depdata1$WSTDVAUT <- as.numeric(depdata1$WSTDVAUT)
depdata1$WSTDVJST <- as.numeric(depdata1$WSTDVJST)
depdata1$WSTDVSOC <- as.numeric(depdata1$WSTDVSOC)

#Renaming and working using this data set. This data set has individuals aged from 18-64. It has 36892 participants. Work satisfaction and job security not filtered out in this data set as >45000 individuals would have been dropped. A separate analysis will be done after filtering out those variables.
depdata18to64 <- depdata1 %>%
  filter(!DHHGAGE %in% c("Age between 65 and 69","Age between 70 and 74"))

#3433 



#Which age grouping to use? 18-25 25-40 40-65. unable to. [18-29] = 7606 [30-49] = 18382 [50-64] = 12707

agebracket <- c("[18-29]","[30-49]","[50-64]")
groupdep <- c("Low Depression","High Depression")
stress.cat <- c("Low Work Stress","Medium Work stress","High Work stress")
wrkstress <- c("No work stress","Minimal work stress", "High work stress")
lifestress <- c("No life stress","Minimal Life stress","High Life stress")

depdata18to64.test <- depdata18to64 %>%
  mutate(agebracket = case_when(
    DHHGAGE %in% c("Age between 18 and 19")~agebracket[1],
    DHHGAGE %in% c("Age between 20 and 24")~agebracket[1],
    DHHGAGE %in% c("Age between 25 and 29")~agebracket[1],
    DHHGAGE %in% c("Age between 30 and 34")~agebracket[2],
    DHHGAGE %in% c("Age between 35 and 39")~agebracket[2],
    DHHGAGE %in% c("Age between 40 and 44")~agebracket[2],
    DHHGAGE %in% c("Age between 45 and 49")~agebracket[2],
    DHHGAGE %in% c("Age between 50 and 54")~agebracket[3],
    DHHGAGE %in% c("Age between 55 and 59")~agebracket[3],
    DHHGAGE %in% c("Age between 60 and 64")~agebracket[3],
    DHHGAGE %in% c("Age between 65 and 69")~agebracket[3])
  )

depdata18to64.test <- depdata18to64.test %>%
  mutate(groupdep = case_when(
    DEPDVSEV %in% c("No depression")~groupdep[1],
    DEPDVSEV %in% c("Minimal depression")~groupdep[1],
    DEPDVSEV %in% c("Mild depression")~groupdep[1],
    DEPDVSEV %in% c("Moderate depression")~groupdep[2],
    DEPDVSEV %in% c("Moderately severe depression")~groupdep[2],
    DEPDVSEV %in% c("Severe depression")~groupdep[2])
  )

depdata18to64.test <- depdata18to64.test %>%
  mutate(Work_Stress = case_when(
    GEN_025 %in% c("Not at all stressful")~wrkstress[1],
    GEN_025 %in% c("Not very stressful")~wrkstress[2],
    GEN_025 %in% c("A bit stressful")~wrkstress[2],
    GEN_025 %in% c("Quite a bit stressful")~wrkstress[3],
    GEN_025 %in% c("Extremely stressful")~wrkstress[3])
  )

depdata18to64.test <- depdata18to64.test %>%
  mutate(Life_stress = case_when(
    GEN_020 %in% c("Not at all stressful")~lifestress[1],
    GEN_020 %in% c("Not very stressful")~lifestress[2],
    GEN_020 %in% c("A bit stressful")~lifestress[2],
    GEN_020 %in% c("Quite a bit stressful")~lifestress[3],
    GEN_020 %in% c("Extremely stressful")~lifestress[3])
  )

# This variable indicates the respondent’s task variety at their main work in the past 12 months. It is based on questions about
# whether the respondent was required to keep learning new things, whether his/her job required a high level of skill and
# whether the job required that the respondent do things over and over (monotony).
# Respondents less than 15 years old or more than 75 years old and respondents who have not worked at a job or business at
# any time in the past 12 months were excluded from the population.
# 1.Higher scores represent lower level of skill discretion.
# 2.According to the original instrument, jobs that offer little decision latitude are associated with indicators of mental health
# such as anxiety and depression.
# 3.Scores were reversed in the temporary reformat for question WST_Q020.


depdata18to64.test <- depdata18to64.test %>%
  mutate(wrkstress.skill = case_when(
    WSTDVSKI %in% c("0")~stress.cat[1],
    WSTDVSKI %in% c("1")~stress.cat[1],
    WSTDVSKI %in% c("2")~stress.cat[1],
    WSTDVSKI %in% c("3")~stress.cat[1],
    WSTDVSKI %in% c("4")~stress.cat[1],
    WSTDVSKI %in% c("5")~stress.cat[2],
    WSTDVSKI %in% c("6")~stress.cat[2],
    WSTDVSKI %in% c("7")~stress.cat[2],
    WSTDVSKI %in% c("8")~stress.cat[2],
    WSTDVSKI %in% c("9")~stress.cat[3],
    WSTDVSKI %in% c("10")~stress.cat[3],
    WSTDVSKI %in% c("11")~stress.cat[3],
    WSTDVSKI %in% c("12")~stress.cat[3],
    WSTDVSKI %in% c("13")~stress.cat[3])
  )


# This variable indicates whether the respondent is free from conflicting demands that others make and if their main job in the
# past 12 months was very hectic.
# Respondents less than 15 years old or more than 75 years old and respondents who have not worked at a job or business at
# any time in the past 12 months were excluded from the population.
# 1.Higher scores indicate greater psychological demands.
# 2.Higher scores indicate greater work stress.
# 3.Scores were inverted in the temporary reformat for question WST_Q025.
depdata18to64.test <- depdata18to64.test %>%
  mutate(wrkstress.psyc = case_when(
    WSTDVPSY %in% c("0")~stress.cat[1],
    WSTDVPSY %in% c("1")~stress.cat[1],
    WSTDVPSY %in% c("2")~stress.cat[1],
    WSTDVPSY %in% c("3")~stress.cat[2],
    WSTDVPSY %in% c("4")~stress.cat[2],
    WSTDVPSY %in% c("5")~stress.cat[2],
    WSTDVPSY %in% c("6")~stress.cat[3],
    WSTDVPSY %in% c("7")~stress.cat[3],
    WSTDVPSY %in% c("8")~stress.cat[3],
    WSTDVPSY %in% c("9")~stress.cat[3])
  )

# This variable indicates how the respondent feels about their level of job security in their main job.
# Respondents less than 15 years old or more than 75 years old and respondents who have not worked at a job or business at
# any time in the past 12 months were excluded from the population. 
# 1. Higher scores indicate greater job insecurity.
# 2. Higher scores indicate greater work stress.

depdata18to64.test <- depdata18to64.test %>%
  mutate(wrkstress.security = case_when(
    WSTDVJIN %in% c("0")~stress.cat[1],
    WSTDVJIN %in% c("1")~stress.cat[1],
    WSTDVJIN %in% c("2")~stress.cat[2],
    WSTDVJIN %in% c("3")~stress.cat[3],
    WSTDVJIN %in% c("4")~stress.cat[3],
    WSTDVJIN %in% c("5")~stress.cat[3])
  )


#This variable indicates whether the main job in the past 12 months requires a lot of physical effort.
#Respondents less than 15 years old or more than 75 years old and respondents who have not worked at a job or business at
#any time in the past 12 months were excluded from the population.
#1. Higher scores indicate greater physical demands at work.
#2. Higher scores indicate greater work stress.
depdata18to64.test <- depdata18to64.test %>%
  mutate(wrkstress.physical = case_when(
    WSTDVPHY %in% c("0")~stress.cat[1],
    WSTDVPHY %in% c("1")~stress.cat[1],
    WSTDVPHY %in% c("2")~stress.cat[2],
    WSTDVPHY %in% c("3")~stress.cat[3],
    WSTDVPHY %in% c("4")~stress.cat[3],
    WSTDVPHY %in% c("5")~stress.cat[3])
  )

# This variable indicates whether the respondent’s main job in the past 12 months allows them freedom in how to do their job
# and if they have a lot of say in what happens with regard to their job. This measure can be used to assess the extent to which
# workers can use their skills and discretion on the job.
# Respondents less than 15 years old or more than 75 years old and respondents who have not worked at a job or business at
# any time in the past 12 months were excluded from the population.
# 1.Higher values indicate lower decision authority.
# 2.Higher scores indicate greater work stress.

depdata18to64.test <- depdata18to64.test %>%
  mutate(wrkstress.authority = case_when(
    WSTDVAUT %in% c("0")~stress.cat[1],
    WSTDVAUT %in% c("1")~stress.cat[1],
    WSTDVAUT %in% c("2")~stress.cat[1],
    WSTDVAUT %in% c("3")~stress.cat[2],
    WSTDVAUT %in% c("4")~stress.cat[2],
    WSTDVAUT %in% c("5")~stress.cat[2],
    WSTDVAUT %in% c("6")~stress.cat[3],
    WSTDVAUT %in% c("7")~stress.cat[3],
    WSTDVAUT %in% c("8")~stress.cat[3],
    WSTDVAUT %in% c("9")~stress.cat[3])
  )

# This variable indicates the social support available to the respondent at his/her main job in the past 12 months. It is based on
# questions about whether or not the respondent's supervisor and the people the respondent worked with were helpful in getting
# the job done, and whether the respondent was exposed to hostility or conflict from the people they worked with.
# Respondents less than 15 years old or more than 75 years old and respondents who have not worked at a job or business at
# any time in the past 12 months were excluded from the population.
# 1.Higher values indicate lower social support at work.
# 2.Higher scores indicate greater work stress.
# 3.Scores were inverted in the temporary reformat for question WST_Q050

depdata18to64.test <- depdata18to64.test %>%
  mutate(wrkstress.social = case_when(
    WSTDVSOC %in% c("0")~stress.cat[1],
    WSTDVSOC %in% c("1")~stress.cat[1],
    WSTDVSOC %in% c("2")~stress.cat[1],
    WSTDVSOC %in% c("3")~stress.cat[1],
    WSTDVSOC %in% c("4")~stress.cat[1],
    WSTDVSOC %in% c("5")~stress.cat[2],
    WSTDVSOC %in% c("6")~stress.cat[2],
    WSTDVSOC %in% c("7")~stress.cat[2],
    WSTDVSOC %in% c("8")~stress.cat[2],
    WSTDVSOC %in% c("9")~stress.cat[3],
    WSTDVSOC %in% c("10")~stress.cat[3],
    WSTDVSOC %in% c("11")~stress.cat[3],
    WSTDVSOC %in% c("12")~stress.cat[3],
    WSTDVSOC %in% c("13")~stress.cat[3])
  )

depdata18to64.test$agebracket <- factor(depdata18to64.test$agebracket,
                                        levels = agebracket,
                                        ordered = FALSE)

depdata18to64.test$groupdep <- factor(depdata18to64.test$groupdep,
                                      levels = groupdep,
                                      ordered = FALSE)

depdata18to64.test$Work_Stress <- factor(depdata18to64.test$Work_Stress,
                                         levels = wrkstress,
                                         ordered = FALSE)

depdata18to64.test$Life_stress <- factor(depdata18to64.test$Life_stress,
                                         levels = lifestress,
                                         ordered = FALSE)

depdata18to64.test$wrkstress.skill <- factor(depdata18to64.test$wrkstress.skill,
                                             levels = stress.cat,
                                             ordered = FALSE)

depdata18to64.test$wrkstress.psyc <- factor(depdata18to64.test$wrkstress.psyc,
                                            levels = stress.cat,
                                            ordered = FALSE)

depdata18to64.test$wrkstress.security <- factor(depdata18to64.test$wrkstress.security,
                                                levels = stress.cat,
                                                ordered = FALSE)

depdata18to64.test$wrkstress.authority <- factor(depdata18to64.test$wrkstress.authority,
                                                 levels = stress.cat,
                                                 ordered = FALSE)

depdata18to64.test$wrkstress.social <- factor(depdata18to64.test$wrkstress.social,
                                              levels = stress.cat,
                                              ordered = FALSE)

depdata18to64.test$wrkstress.physical <- factor(depdata18to64.test$wrkstress.physical,
                                                levels = stress.cat,
                                                ordered = FALSE)


#Converting working data set string data to numerical data using scales for analysis.

#depdata18to64$DEPDVSEV <- sapply(depdata18to64$DEPDVSEV,scale3)

#depdata18to64.test$DODEP <- sapply(depdata18to64.test$DODEP,scale9)
depdata18to64.test$GEN_015 <- sapply(depdata18to64.test$GEN_015,scale1)
#depdata18to64.test$GEN_020 <- sapply(depdata18to64.test$GEN_020,scale7)
#depdata18to64.test$GEN_025 <- sapply(depdata18to64.test$GEN_025,scale7)
depdata18to64.test$LBFDVPFT <- sapply(depdata18to64.test$LBFDVPFT,scale20)
depdata18to64.test$LBFDGOCG <- sapply(depdata18to64.test$LBFDGOCG,scale21)
depdata18to64.test$CCC_195 <- sapply(depdata18to64.test$CCC_195,scale9)
depdata18to64.test$CCC_200 <- sapply(depdata18to64.test$CCC_200,scale9)
depdata18to64.test$GEO_PRV <- sapply(depdata18to64.test$GEO_PRV,scale13)
depdata18to64.test$DHH_SEX <- sapply(depdata18to64.test$DHH_SEX,scale12)
depdata18to64.test$DHHGMS <- sapply(depdata18to64.test$DHHGMS, scale2)

depdata18to64.test$SDCDGCGT <- sapply(depdata18to64.test$SDCDGCGT,scale19)
depdata18to64.test$GENDVHDI <- sapply(depdata18to64.test$GENDVHDI,scale1)
depdata18to64.test$GENDVMHI <- sapply(depdata18to64.test$GENDVMHI,scale1)
depdata18to64.test$INCDGPER <- sapply(depdata18to64.test$INCDGPER,scale5)
depdata18to64.test$INCDGHH <- sapply(depdata18to64.test$INCDGHH,scale10)

depdata18to64.test$ALCDVTTM <- sapply(depdata18to64.test$ALCDVTTM,scale22)
depdata18to64.test$ALC_015 <- sapply(depdata18to64.test$ALC_015,scale23)
depdata18to64.test$SMK_005 <- sapply(depdata18to64.test$SMK_005,scale28)
depdata18to64.test$SMKDVSTY <- sapply(depdata18to64.test$SMKDVSTY,scale24)
depdata18to64.test$HWTDGISW <- sapply(depdata18to64.test$HWTDGISW,scale25)
depdata18to64.test$EHG2DVR3 <- sapply(depdata18to64.test$EHG2DVR3,scale27)
#adding extra data to data set
#deprace <- dplyr::select(x, ADM_RNO, SDCDGCGT)
#depdata <- left_join(depdata, deprace, by ="ADM_RNO")





```

```{r}
library(kableExtra)
library(pixiedust)
library(magick)
library(htmlTable)

#Creating factors to for data analysis
#factor.dep.severity <- factor(depdata18to64.factor$DEPDVSEV, levels = c(0,1,2,3,4,5))
factor.mentalhealth <- factor(depdata18to64.test$GEN_015, levels= c(0,1,2,3,4))
#factor.lifestress <- factor(depdata18to64.test$GEN_020, levels= c(0,1,2,3,4))
#factor.workstress <- factor(depdata18to64.test$GEN_025, levels= c(0,1,2,3,4))
factor.worktype <- factor(depdata18to64.test$LBFDGOCG, levels = c(0,1,2,3,4))
factor.location <- factor(depdata18to64.test$GEO_PRV, levels = c(0,1,2,3,4,5,6,7,8,9,10,11,12))
factor.martial <- factor(depdata18to64.test$DHHGMS, levels = c(0,1,2,3))
factor.perceivedhealth <- factor(depdata18to64.test$GENDVHDI, levels = c(0,1,2,3,4))
factor.perceivedmenhealth <- factor(depdata18to64.test$GENDVMHI, levels = c(0,1,2,3,4))
factor.incomepersonal <- factor(depdata18to64.test$INCDGPER, levels = c(0,1,2,3,4,5))
factor.incomehousehold <- factor(depdata18to64.test$INCDGHH, levels = c(0,1,2,3,4))
factor.alcfreq <- factor(depdata18to64.test$ALC_015, levels = c(0,1,2,3,4,5,6))
factor.smkrtype <-factor(depdata18to64.test$SMK_005, levels = c(0,1,2))
factor.smkstatus <- factor(depdata18to64.test$SMKDVSTY, levels = c(0,1,2,3,4,5))
factor.bmi <- factor(depdata18to64.test$HWTDGISW, levels = c(0,1,2,3))
factor.edu <- factor(depdata18to64.test$EHG2DVR3, levels = c(0,1,2))
factor.race <- factor(depdata18to64.test$SDCDGCGT, levels = c(0,1))

dep.wrkhours <- glm(depdata18to64.test$groupdep ~ depdata18to64.test$LBFDGHPW, family = "binomial")

#Forward stepwise regression to determine variables to add 
full <- glm(depdata18to64.test$groupdep ~ depdata18to64.test$LBFDGHPW + depdata18to64.test$Work_Stress  + depdata18to64.test$Life_stress + 
              depdata18to64.test$LBFDVPFT + factor.worktype + depdata18to64.test$DHH_SEX + factor.martial + depdata18to64.test$SDCDGCGT + 
              factor.incomehousehold + depdata18to64.test$ALCDVTTM + factor.alcfreq + factor.smkrtype + factor.smkstatus + factor.bmi + 
              factor.edu + depdata18to64.test$agebracket + depdata18to64.test$wrkstress.skill + depdata18to64.test$wrkstress.psyc + 
              depdata18to64.test$wrkstress.security + depdata18to64.test$wrkstress.physical + depdata18to64.test$wrkstress.authority + 
              depdata18to64.test$wrkstress.social, family = "binomial")

null <- glm(depdata18to64.test$groupdep ~ 1, family ='binomial')


step(null, scope = list(lower=null, upper= full), direction="forward")

#start AIC 1652.26
#end AIC 1359

dep.wrkhoursfull<- glm(formula = depdata18to64.test$groupdep ~ depdata18to64.test$LBFDGHPW + depdata18to64.test$wrkstress.skill + 
                         depdata18to64.test$wrkstress.security + depdata18to64.test$wrkstress.authority + depdata18to64.test$wrkstress.social + 
                         factor.incomehousehold + depdata18to64.test$agebracket +depdata18to64.test$SDCDGCGT + factor.smkrtype + factor.bmi + 
                         depdata18to64.test$Life_stress, family = "binomial")

summary(dep.wrkhoursfull)

```

```{r}
library(kableExtra)
library(pixiedust)
library(MASS)
library(magick)
library(htmlTable)


#adding results to a data frame
dep.results <- data.frame(coef(summary(dep.wrkhoursfull))[])

#dropping z.value
dep.results <- dep.results[-3]

#adding Odds ratios for analysis 
dep.results <- dep.results %>%
  mutate(OR = exp(dep.results$Estimate[])
  )

#Confidence intervals 
dep.resultsCI <- exp(confint(dep.wrkhoursfull)
)

#Combining confidence intervals with table. expon. results to show the confidence interval in Odds rather than log odds
dep.resultsfull <- cbind(dep.results,dep.resultsCI)
#dep.resultsfull[,5] <- exp(dep.resultsfull[,5])
#dep.resultsfull[,6] <- exp(dep.resultsfull[,6])


#rounding results to 3 decimal places
dep.resultsfull <- round(dep.resultsfull,3)

#getting crude OR and confint
workhours.crude <- glm(depdata18to64.test$groupdep ~ depdata18to64.test$LBFDGHPW, family = "binomial")
wrkstr.skillcrude <- glm(depdata18to64.test$groupdep ~ depdata18to64.test$wrkstress.skill, family = "binomial")
wrkstr.secucrude <- glm(depdata18to64.test$groupdep ~ depdata18to64.test$wrkstress.security, family = "binomial")
wrkstr.authcrude <- glm(depdata18to64.test$groupdep ~ depdata18to64.test$wrkstress.authority, family = "binomial")
wrkstr.soccrude <- glm(depdata18to64.test$groupdep ~ depdata18to64.test$wrkstress.social, family = "binomial")

hhinc.crude <- glm(depdata18to64.test$groupdep ~ factor.incomehousehold, family = "binomial")
age.crude <- glm(depdata18to64.test$groupdep ~ depdata18to64.test$agebracket, family = "binomial")
rb.crude <- glm(depdata18to64.test$groupdep ~ depdata18to64.test$SDCDGCGT, family = "binomial")
smktype.crude <- glm(depdata18to64.test$groupdep ~ factor.smkrtype, family = "binomial")
bmi.crude <- glm(depdata18to64.test$groupdep ~ factor.bmi, family = "binomial")
lifestres.crude <- glm(depdata18to64.test$groupdep ~ depdata18to64.test$Life_stress, family = "binomial")


crude.coef1 <- data.frame(coef(workhours.crude)[-1])
colnames(crude.coef1) <- "or"

crude.coef2 <- data.frame(coef(wrkstr.skillcrude)[-1])
colnames(crude.coef2) <- "or"

crude.coef3 <- data.frame(coef(wrkstr.secucrude)[-1])
colnames(crude.coef3) <- "or"

crude.coef4 <- data.frame(coef(wrkstr.authcrude)[-1])
colnames(crude.coef4) <- "or"

crude.coef5 <- data.frame(coef(wrkstr.soccrude)[-1])
colnames(crude.coef5) <- "or"

crude.coef6 <- data.frame(coef(hhinc.crude)[-1])
colnames(crude.coef6) <- "or"

crude.coef7 <- data.frame(coef(age.crude)[-1])
colnames(crude.coef7) <- "or"

crude.coef8 <- data.frame(coef(rb.crude)[-1])
colnames(crude.coef8) <- "or"

crude.coef9 <- data.frame(coef(smktype.crude)[-1])
colnames(crude.coef9) <- "or"

crude.coef10 <- data.frame(coef(bmi.crude)[-1])
colnames(crude.coef10) <- "or"

crude.coef11 <- data.frame(coef(lifestres.crude)[-1])
colnames(crude.coef11) <- "or"

#Combining crude coef values and coverting them into OR
crude.coef <- dplyr::bind_rows(crude.coef1,crude.coef2,crude.coef3,crude.coef4,crude.coef5,
                               crude.coef6,crude.coef7,crude.coef8,crude.coef9,crude.coef10,
                               crude.coef11)
crude.coef <- exp(crude.coef)

#Confidence intervals 

crudeconf1 <- exp(confint(workhours.crude))
crudeconf2 <- exp(confint(wrkstr.skillcrude))
crudeconf3 <- exp(confint(wrkstr.secucrude))
crudeconf4 <- exp(confint(wrkstr.authcrude))
crudeconf5 <- exp(confint(wrkstr.soccrude))
crudeconf6 <- exp(confint(hhinc.crude))
crudeconf7 <- exp(confint(age.crude))
crudeconf8 <- exp(confint(rb.crude))
crudeconf9 <- exp(confint(smktype.crude))
crudeconf10 <- exp(confint(bmi.crude))
crudeconf11 <- exp(confint(lifestres.crude))

crude.conf <- dplyr::union_all(crudeconf1,crudeconf2,crudeconf3,crudeconf4,crudeconf5,
                               crudeconf6,crudeconf7,crudeconf8,crudeconf9,crudeconf10,
                               crudeconf11)

crude.conf <- crude.conf[-c(1,3,6,9,12,15,20,23,25,28,32),]


dep.resultsfullcrude <- cbind(crude.coef,crude.conf)
colnames(dep.resultsfullcrude) <- c("OR","2.5%","97.5%")
#rounding results to 3 decimal places
dep.resultsfullcrude <- round(dep.resultsfullcrude,3)         

#Renaming Rows 
rownames(dep.resultsfull) <- c("Intercept",
                               "Hours worked per week",
                               "Medium skill",
                               "Low skill",
                               "Job security 2,3",
                               "Job security 4,5",
                               "Work authority 3,4,5",
                               "Work authority 6,7,8,9",
                               "Social support 5,6,7,8",
                               "Social support 9,10,11,12,13",
                               "20,000 to $39,999",
                               "40,000 to $59,999",
                               "60,000 to $79,999",
                               "80,000 or more",
                               "Age 30 - 49",
                               "Age 50 - 64",
                               "Non-white (Aboriginal or Other Visible Minority)",
                               "Occasional smoker",
                               "Daily smoker",
                               "Underweight",
                               "Overweight",
                               "Obese - Class I, II, III",
                               "Minimal Life stress",
                               "High Life stress"
)

Adjusted.OR <- c("0.032 (0.008 - 0.111)",
                 "0.980 (0.969 - 0.991)",
                 "2.074 (1.358 - 3.278)",
                 "3.924 (2.229 - 6.984)",
                 "1.048 (0.740 - 1.489)",
                 "1.898 (1.243 - 2.885)",
                 "1.365 (0.925 - 2.052)",
                 "1.908 (1.178 - 3.103)",
                 "1.027 (0.741 - 1.419)",
                 "1.983 (1.150 - 3.335)",
                 "0.495 (0.242 - 1.036)",
                 "0.346 (0.170 - 0.725)",
                 "0.587 (0.291 - 1.220)",
                 "0.286 (0.150 - 0.567)",
                 "0.723 (0.502 - 1.046)",
                 "0.512 (0.335 - 0.781)",
                 "0.568 (0.277 - 1.058)",
                 "1.451 (0.714 - 2.718)",
                 "1.890 (1.338 - 2.648)",
                 "1.768 (0.507 - 5.238)",
                 "1.384 (0.942 - 2.038)",
                 "2.021 (1.391 - 2.953)",
                 "1.903 (0.824 - 5.548)",
                 "11.286 (4.887 - 32.909)")

Crude.OR <- c("-",
              "0.976 (0.966 - 0.986)",
              "2.349 (1.576 - 3.638)",
              "6.105 (3.715 - 10.200)",
              "1.212 (0.882 - 1.671)",
              "3.227 (2.238 - 4.640)",
              "1.561 (1.094 - 2.275)",
              "3.865 (2.555 - 5.906)",
              "1.423 (1.061 - 1.904)",
              "4.608 (2.894 - 7.159)",
              "0.467 (0.255 - 0.876)",
              "0.290 (0.158 - 0.543)",
              "0.379 (0.211 - 0.699)",
              "0.185 (0.109 - 0.327)",
              "0.737 (0.538 - 1.016)",
              "0.561 (0.384 - 0.814)",
              "0.558 (0.283 - 0.988)",
              "1.326 (0.684 - 2.345)",
              "2.264 (1.665 - 3.051)",
              "3.454 (1.264 - 8.035)",
              "1.091 (0.769 - 1.550)",
              "1.653 (1.184 - 2.317)",
              "1.837 (0.817 - 5.254)",
              "10.600 (4.752 - 30.191)")

dep.resultsfull[,4] <- Crude.OR
dep.resultsfull[,5] <- Adjusted.OR

#Renaming columns
dep.resultsfull <- dep.resultsfull %>%
  rename(
    "Standard Error" = Std..Error,
    "Crude OR" = OR,
    "Adjusted OR" = "2.5 %",
    Pvalue = Pr...z..
  )

dep.resultsfull <- dep.resultsfull[1:5]
#dep.resultsfull[,3] <- round(dep.results[,3],3)

dep.resultsfull %>% 
  kbl(caption = "This is a title placeholder to be changed later") %>%
  kable_paper("striped",full_width = FALSE,position = "center") %>%
  #add_header_above(c("","", "","","", "95% Confidence Interval (log odds)"=2))%>%
  pack_rows("Working Hours", 2,2,label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("Work Skill level", 3,4,label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("Job Security", 5,6,label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("Work Authority", 7,8,label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("Co-Worker support", 9,10,label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("Household income", 11,14,label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("Age", 15,16,label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("Racial Background", 17,17,label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("Smoking Status", 18,19,label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("BMI", 20,22,label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("Life Stress", 23,24,label_row_css = "background-color: #666; color: #fff;") %>%
  footnote(general = "OR = Odds Ratio",
           number = c("Number of individuals (n) in study = 36892","Estimate, Standard Error and, P value are based off adjusted model"),
           general_title = "General:",
           title_format = c("italic","underline")
  ) %>%
  column_spec(4,
              bold = T, 
              color = ifelse(dep.resultsfull$Pvalue > 0.05, "red","grey")
  )
```

```{r}
library(hrbrthemes)
library(gridExtra)
library(grid)
library(summarytools)

depdata.graph <- depdata1 %>%
  filter(!DHHGAGE %in% c("Age between 65 and 69","Age between 70 and 74"))

#1756
depdata.male <- depdata.graph %>%
  filter(DHH_SEX == "Male")
#1677
depdata.female <- depdata.graph %>%
  filter(DHH_SEX == "Female")

malehours <- data.frame(x = depdata.male$LBFDGHPW)
femalehours <- data.frame(x = depdata.female$LBFDGHPW)
allhours <- data.frame(x=depdata.graph$LBFDGHPW)


mfhours <-ggplot()+
  aes(x=x)+
  geom_histogram(data = malehours, fill = "#33ccff", alpha = 0.6, binwidth = 12) +
  geom_histogram(data = femalehours, fill ="#ff99ff", alpha = 0.6, binwidth = 12)+
  xlab("Hours worked (weekly)") +
  ylab("Frequency")

mfhours + theme(panel.grid.major = element_blank(),
                axis.ticks = element_blank())




depdata.summary <- dplyr::select(depdata18to64, ADM_RNO, DEPDVSEV,LBFDGHPW, LBFDVPFT, LBFDGOCG,
                                 DHH_SEX,DHHGMS,DHHGAGE,SDCDGCGT,INCDGHH,GENDVHDI, GENDVMHI,
                                 ALCDVTTM, SMK_005,SMKDVSTY,HWTDGISW,EHG2DVR3)

depdata.summary1 <- dplyr:: select(depdata18to64.test, ADM_RNO, agebracket,Work_Stress,groupdep)
depdata.summary1 <- dplyr::left_join(depdata.summary, depdata.summary1, by= "ADM_RNO")

# depdata.summary <- depdata1 %>%
#   filter(!DHHGAGE %in% c("Age between 65 and 69","Age between 70 and 74"))

# depdata.summary$DODEP <- sapply(depdata.summary$DODEP,scale9b)

depdata.summary1 <- depdata.summary1 %>%
  rename(
    "Depression Severity" = DEPDVSEV,
    'Workhours' = LBFDGHPW,
    Part_Fulltime_Work = LBFDVPFT,
    'Work type' = LBFDGOCG,
    Sex = DHH_SEX,
    Martial_Status = DHHGMS,
    Age = DHHGAGE,
    Racial_background = SDCDGCGT,
    Household_income = INCDGHH,
    "Perceived Health (General)" = GENDVHDI,
    "Perceived Mental Health" = GENDVMHI,
    "Type of drinker (Last 12 months)" = ALCDVTTM,
    "Smoking status " = SMKDVSTY,
    "Type of smoker)" = SMK_005,
    BMI = HWTDGISW,
    Education = EHG2DVR3
  )

view(dfSummary(depdata50to64, plain.ascii = FALSE, style = "grid", 
               graph.magnif = 0.75, valid.col = FALSE, tmp.img.dir = "/tmp"))

#Tables for report
depdatafull <- data.frame(matrix(ncol = 3, nrow = 52))

colnames(depdatafull) <- c ("", "","")
rownames(depdatafull) <- c("Average hours worked per week",
                               "No depression",
                               "Minimal depression",
                               "Mild depression",
                               "Moderate depression",
                               "Moderately severe depression",
                               "Severe depression",
                               "Male",
                               "Female",
                               "White",
                               "Non-white (Aboriginal or Other Visible Minority)",
                               "Married",
                               "Common-law",
                               "Widowed/Divorced/Separate",
                               "Single",
                               "Less than secondary school",
                               "Secondary school graduation",
                               "Post-secondary",
                               "Full time",
                               "Part time",
                               "No income or less than 20 000",
                               "20,000 to 39,999",
                               "40,000 to 59,999",
                               "60,000 to 79,999",
                               "80,000 or more",
                               "No work stress",
                               "Minimal work stress",
                               "High work stress" ,  
                               "NOC 1,3,4,5,6",
                               "NOC 2",
                               "NOC 6",
                               "NOC 7",
                               "NOC 8,9",
                               "Poor (General)",
                               "Fair (General)",
                               "Good (General)",
                               "Very Good (General)",
                               "Excellent (General)",
                               "Poor",
                               "Fair",
                               "Good",
                               "Very Good",
                               "Excellent",
                               "Underweight",
                               "Normal weight",
                               "Overweight",
                               "Obese - Class I, II, III",
                               "Regular drinker",
                               "Occasional drinker",
                               "Daily",
                               "Occasionally",
                               "Not at all"
  
)
#808
depdata18to29 <- depdata.summary1 %>%
  filter(agebracket == "[18-29]")
#1600
depdata30to49 <- depdata.summary1 %>%
  filter(agebracket == "[30-49]")
#1025
depdata50to64 <- depdata.summary1 %>%
  filter(agebracket == "[50-64]")

dep18to29 <- c("41 (2 - 98)",
               "268 (33.2%)",
               "342 (42.3%)",
               "129 (16.0%)",
               "47 (5.8%)",
               "17 (2.1%)",
               "5 (0.6%)",
               "440 (54.5%)",
               "368 (45.5%)",
               "714 (88.4%)",
               "94 (11.6%)",
               "147 (18.2%)",
               "134 (16.6%)",
               "15 (1.9%)",
               "512 (63.4%)",
               "46 (5.7%)",
               "325 (40.2%)",
               "437 (54.1%)",
               "683 (84.5%)",
               "125 (15.5%)",
               #income
               "48 (5.9%)",
               "115 (14.2%)",
               "134 (16.6%)",
               "102 (12.6%)",
               "409 (50.6%)",
               "53 (6.6%)",
               "582 (72.0%)",
               "173 (21.4%)",
               #noc
               "247 (30.6%)",
               "90 (11.1%)",
               "235 (29.1%)",
               "177 (21.9%)",
               "59 (7.3%)",
               "4 (0.5%)",
               "39 (4.8%)",
               "178 (22.0%)",
               "372 (46.0%)",
               "215 (26.6%)",
               "8 (1.0%)",
               "48 (5.9%)",
               "167 (20.7%)",
               "320 (39.6%)",
               "265 (32.8%)",
               "18 (2.2%)",
               "400 (49.5%)",
               "245 (30.3%)",
               "145 (17.9%)",
               "666 (82.4%)",
               "142 (17.6%)",
               "127 (15.7%)" ,
               "64 (7.9%)",
               "617 (76.4%)"
               )

dep30to49 <- c("41 (2 - 98)",
               "619 (38.7%)",
               "636 (39.8%)",
               "242 (15.1%)",
               "74 (4.6%)",
               "22 (1.4%)",
               "7 (0.4%)",
               "808 (50.5%)",
               "792 (49.5%)",
               
               "1442 (90.1%)",
               "158 (9.9%)",
               
               "945 (59.1%)",
               "161 (10.1%)",
               "181 (11.3%)",
               "313 (19.6%)",
               
               "94 (5.9%)",
               "354 (22.1%)",
               "1152 (72.0%)",
               
               "1467 (91.7%)",
               "133 (8.3%)",
               #income
               "30 (1.9%)",
               "122 (7.6%)",
               "204 (12.8%)",
               "224 (14.0%)",
               "1020 (63.7%)",
               
               "107 (6.7%)",
               "1075 (67.2%)",
               "418 (26.1%)",
               #noc
               "698 (43.6%)",
               "256 (16.0%)",
               "259 (16.2%)",
               "270 (16.9%)",
               "117 (7.3%)",
               
               "9 (0.6%)",
               "80 (5.0%)",
               "401 (25.1%)",
               "715 (44.7%)",
               "395 (24.7%)",
               
               "16 (1.0%)",
               "72 (4.5%)",
               "325 (20.3%)",
               "692 (43.2%)",
               "495 (30.9%)",
               
               "17 (1.1%)",
               "537 (33.6%)",
               "535 (33.4%)",
               "511 (31.9%)",
               
               "1280 (80.0%)",
               "320 (20.0%)",
               
               "295 (18.4%)" ,
               "80 (5.0%)",
               "1225 (76.6%)")

dep50to64 <- c("41 (4 - 98)",
               "445 (43.4%)",
               "382 (37.3%)",
               "147 (14.3%)",
               "30 (2.9%)",
               "14 (1.4%)",
               "7 (0.7%)",
               "508 (49.6%)",
               "517 (50.4%)",
               
               "993 (96.9%)",
               "32 (3.1%)",
               
               "637 (62.2%)",
               "79 (7.7%)",
               "212 (20.7%)",
               "97 (9.5%)",
               
               "121 (11.8%)",
               "266 (25.9%)",
               "638 (62.2%)",
               
               "903 (88.1%)",
               "122 (11.9%)",
               #income
               "15 (1.5%)",
               "90 (8.8%)",
               "153 (14.9%)",
               "148 (14.4%)",
               "619 (60.4%)",
               
               "100 (9.8%)",
               "677 (66.0%)",
               "248 (24.2%)",
               #noc
               "377 (36.8%)",
               "191 (18.6%)",
               "210 (20.5%)",
               "177 (17.3%)",
               "70 (6.8%)",
               
               "12 (1.2%)",
               "86 (8.4%)",
               "318 (31.0%)",
               "426 (41.6%)",
               "183 (17.8%)",
               
               "11 (1.1%)",
               "45 (4.4%)",
               "218 (21.3%)",
               "425 (41.5%)",
               "326 (31.8%)",
               
               "2 (0.2%)",
               "288 (28.1%)",
               "400 (39.0%)",
               "335 (32.7%)",
               
               "809 (78.9%)",
               "216 (21.1%)",
               
               "186 (18.1%)" ,
               "28 (2.7%)",
               "811 (79.1%)")

depdatafull[,1] <- dep18to29
depdatafull[,2] <- dep30to49
depdatafull[,3] <- dep50to64

depdatafull %>% 
  kbl(caption = "Table 1: Demographic and variable data from participants from the 2015-2016 Canadian Community Healthy Survey, by age group", ) %>%
  kable_classic(full_width = FALSE,position = "center") %>%
  add_header_above(c(" "=1,"(n = 808)"=1,"(n = 1600)"=1,"(n = 1025)"=1)) %>%
  add_header_above(c(" "=1,"18-29"=1,"30-49"=1,"50-64"=1))%>%
  add_header_above(c(" "=1, "Age group,yr; frequency of respondents (with percentages)"=3)) %>%
  pack_rows("Depression severity", 2, 7) %>%
  pack_rows("Sex", 8, 9) %>%
  pack_rows("Racial background", 10, 11) %>%
  pack_rows("Martial Status", 12, 15) %>%
  pack_rows("Education", 16, 18) %>%
  pack_rows("Work Status", 19, 20) %>%
  pack_rows("Household income", 21, 25) %>%
  pack_rows("Work stress", 26, 28) %>%
  pack_rows("Work group", 29, 33) %>%
  pack_rows("Perceived general health", 34,38 ) %>%
  pack_rows("Perceived mental health", 39, 43) %>%
  pack_rows("BMI", 44, 47) %>%
  pack_rows("Drinking Frequency", 48, 49) %>%
  pack_rows("Smoking status", 50, 52)


View(dep.resultsfull)

dep.resultsor <- dep.resultsfull[-1,4:5]

rownames(dep.resultsfull) <- c("Hours worked per week",
                               "High job skill",
                               "Medium job skill",
                               "Low job skill",
                               "High job security",
                               "Average job security",
                               "Low job security",
                               "Work authority 3,4,5",
                               "Work authority 6,7,8,9",
                               "Social support 5,6,7,8",
                               "Social support 9,10,11,12,13",
                               "20,000 to $39,999",
                               "40,000 to $59,999",
                               "60,000 to $79,999",
                               "80,000 or more",
                               "Age 30 - 49",
                               "Age 50 - 64",
                               "Non-white (Aboriginal or Other Visible Minority)",
                               "Occasional smoker",
                               "Daily smoker",
                               "Underweight",
                               "Overweight",
                               "Obese - Class I, II, III",
                               "Minimal Life stress",
                               "High Life stress"
)

AdjustedOR <- c("0.980 (0.969 - 0.991)",
                 "2.074 (1.358 - 3.278)",
                 "3.924 (2.229 - 6.984)",
                 "1.048 (0.740 - 1.489)",
                 "1.898 (1.243 - 2.885)",
                 "1.365 (0.925 - 2.052)",
                 "1.908 (1.178 - 3.103)",
                 "1.027 (0.741 - 1.419)",
                 "1.983 (1.150 - 3.335)",
                 "0.495 (0.242 - 1.036)",
                 "0.346 (0.170 - 0.725)",
                 "0.587 (0.291 - 1.220)",
                 "0.286 (0.150 - 0.567)",
                 "0.723 (0.502 - 1.046)",
                 "0.512 (0.335 - 0.781)",
                 "0.568 (0.277 - 1.058)",
                 "1.451 (0.714 - 2.718)",
                 "1.890 (1.338 - 2.648)",
                 "1.768 (0.507 - 5.238)",
                 "1.384 (0.942 - 2.038)",
                 "2.021 (1.391 - 2.953)",
                 "1.903 (0.824 - 5.548)",
                 "11.286 (4.887 - 32.909)")

CrudeOR <- c("0.976 (0.966 - 0.986)",
              "2.349 (1.576 - 3.638)",
              "6.105 (3.715 - 10.200)",
              "1.212 (0.882 - 1.671)",
              "3.227 (2.238 - 4.640)",
              "1.561 (1.094 - 2.275)",
              "3.865 (2.555 - 5.906)",
              "1.423 (1.061 - 1.904)",
              "4.608 (2.894 - 7.159)",
              "0.467 (0.255 - 0.876)",
              "0.290 (0.158 - 0.543)",
              "0.379 (0.211 - 0.699)",
              "0.185 (0.109 - 0.327)",
              "0.737 (0.538 - 1.016)",
              "0.561 (0.384 - 0.814)",
              "0.558 (0.283 - 0.988)",
              "1.326 (0.684 - 2.345)",
              "2.264 (1.665 - 3.051)",
              "3.454 (1.264 - 8.035)",
              "1.091 (0.769 - 1.550)",
              "1.653 (1.184 - 2.317)",
              "1.837 (0.817 - 5.254)",
              "10.600 (4.752 - 30.191)")

```
